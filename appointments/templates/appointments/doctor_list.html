{% extends 'base.html' %}

{% block title %}Find Doctors{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold"><i class="bi bi-people me-2"></i>Find a Doctor</h2>
        <p class="text-muted">Browse our network of verified healthcare professionals</p>
    </div>
    
    <!-- Filters -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="get" class="row g-3 align-items-center">
                <div class="col-auto">
                    <label class="form-label mb-0">Filter by Specialization:</label>
                </div>
                <div class="col-md-4">
                    <select name="specialization" class="form-select" onchange="this.form.submit()">
                        <option value="">All Specializations</option>
                        {% for value, label in specializations %}
                        <option value="{{ value }}" {% if specialization_filter == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Doctors Grid -->
    {% if doctors %}
    <div class="row g-4">
        {% for doctor in doctors %}
        <div class="col-md-6 col-lg-4">
            <div class="card doctor-card h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-primary text-white rounded-circle p-3 me-3">
                            <i class="bi bi-person-badge fs-4"></i>
                        </div>
                        <div>
                            <h5 class="mb-1">Dr. {{ doctor.user.get_full_name }}</h5>
                            <span class="specialty-badge">{{ doctor.get_specialization_display }}</span>
                        </div>
                    </div>
                    
                    {% if doctor.bio %}
                    <p class="text-muted small mb-3">{{ doctor.bio|truncatechars:100 }}</p>
                    {% endif %}
                    
                    <div class="mb-3">
                        <p class="mb-1">
                            <i class="bi bi-briefcase text-primary me-2"></i>
                            <span>{{ doctor.experience_years }} years experience</span>
                        </p>
                        <p class="mb-1">
                            <i class="bi bi-currency-dollar text-primary me-2"></i>
                            <span>Consultation: ${{ doctor.consultation_fee }}</span>
                        </p>
                        <p class="mb-0">
                            <i class="bi bi-check-circle text-success me-2"></i>
                            <span class="text-success">Available for appointments</span>
                        </p>
                    </div>
                </div>
                <div class="card-footer bg-white">
                    {% if user.is_authenticated and user.is_patient %}
                    <a href="{% url 'book_appointment' %}?doctor={{ doctor.id }}" class="btn btn-primary w-100">
                        <i class="bi bi-calendar-plus me-2"></i>Book Appointment
                    </a>
                    {% elif not user.is_authenticated %}
                    <a href="{% url 'login' %}" class="btn btn-outline-primary w-100">
                        <i class="bi bi-box-arrow-in-right me-2"></i>Login to Book
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="card">
        <div class="card-body text-center py-5">
            <i class="bi bi-people display-1 text-muted"></i>
            <h4 class="mt-3">No Doctors Found</h4>
            <p class="text-muted">{% if specialization_filter %}No doctors found for this specialization.{% else %}No doctors available at the moment.{% endif %}</p>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
